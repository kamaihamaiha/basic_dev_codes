## 复合类型

[代码](../../chapter_2/section_3/main.cpp)

复合类型(compound type) 是指基于其他类型定义的类型。   
- C++ 有几种复合类型，这里介绍其中两种：**引用**和**指针**。
- 一条声明语句：基本数据类型(base type) + 声明符(declarator)
    - 声明符命名了一个变量，并指定该变量为与基本数据类型有关的某种类型
    - 目前为止，我们所解除的声明语句中，声明符其实就是变量名。
    
### 引用

引用(reference)为对象起了另外一个名字，引用类型引用(refers to) 另外一种类型。如下：
```c++
int value = 1024;
int &ref_value = value;   // ref_value 指向 value(是 value 的另一个名字)
int &ref_value2;          // 错误：引用必须初始化
```

一般在初始化变量时，初始值会被拷贝到新建的对象中。但是定义引用时，程序把引用和他的   
初始值**绑定**(bind)在一起。一旦初始化完成，引用将和他的初始值对象一直绑定在一起。   
因为无法令引用重新绑定到另外一个对象，因此引用**必须初始化**。

注意：
  - 引用不能再定义引用，因为引用不是一个对象。
  - 引用只能绑定在对象身上，不能与字面值或者某个表达式的计算结果绑定在一起

#### 引用即别名

应用并非对象，他只是为一个已经存在的对象所起的另外一个名字。

---
### 指针

指针(pointer) 是指向另外一种类型的复合类型。

- 与引用类似，指针也实现类对其他对象的间接访问。
- 但是也有**不同**：
  - 指针本身就是一个对象，允许对指针赋值和拷贝
  - 指针无须在定义时赋初值。和其他内置类型一样，在块作用域内定义的指针如果没有初始化，也会是一个不确定值
  
#### 定义方法
```c++
int *p;     // p 是指向 int 型对象的指针
double *d;  // d 是指向 double 型对象的指针
```

#### 获取对象的地址
用到**取地址符**(&)
```c++
int i = 1;
int *p = &i;  // p 存放变量 i 的地址，或者说 p 是指向变量 i 的指针
```
注意：指针的类型要和它指向的变量的类型匹配

#### 指针值

指针的值（即地址）应属于下列 4 种状态之一：

1. 指向一个对象
2. 指向紧邻对象所占空间的下一个位置
3. 空指针，意味着指针没有指向任何对象
4. 无效指针，也就是上述情况之外的其他值

注意：试图拷贝或者以其他方式访问无效指针的值都将引发错误。编译器不负责检查此类错误。

#### 利用指针访问对象

如果指针指向了一个对象，则允许使用 **解引用符**(操作符*)来访问该对象：
```c++
int i = 1;
int *p  = &i;

// 访问对象 i，通过 * 方式
cout << *p;
```

#### 空指针

空指针(null pointer)不指向任何对象。以下列出生成空指针的方法：
```c++
int *p1 = nullptr;
int *p2 = 0;
int *p3 = NULL; // 要：include <cstdlib>
```
建议初始化所有指针。

#### 赋值和指针
赋值永远改变的是等号左侧的对象。

#### 其他指针操作
#### 1. 只要指针拥有一个合法值，就能将它用在条件表达式中。   
- 如果指针的值是 0，则条件取 false
- 任何非 0 指针，条件值都是 true
```c++
int value = 1;
int *p1 = 0;
int *p2 = &value;

if(p1) { // false
  
}    

if(p2) { // true
  
}
  
```

#### 2. 指针之间比较
用操作符：`==` 或者 `!=`   
如果两个指针存放的地址值相等，则他们相等。有三种情况：

1. 它们都为空
2. 都指向同一对象
3. 都指向同一对象的下一地址

#### void* 指针

void* 是一种特殊的指针类型，可用于存放任意对象的地址。

但是，这种指针能做的事情较少：
1. 和别的指针比较
2. 作为函数的输入或输出
3. 赋值给另外一个 void* 指针所指的对象

#### 理解复合类型的声明

江湖有两种写法：

第一种：
```c++
int *p1, *p2;
```
注：强调变量具有的复合类型

第二种：
```c++
int* p1;
int* p2;
```
注：强调本次声明定义了一种复合类型

##### 指向指针的指针

一般来说，声明符中的修饰符的个数并没有限制。以指针为例，允许把指针的地址存放到另外一个指针中。
```c++
int i = 100;
int *p = &i;    // p 指向 int 型的数
int **pp = &p;   // pp 指向 int 型的指针。二级指针
```

##### 指向指针的引用

```c++
int i = 2;
int *p;       // p 是一个 int 型指针
int *&r = p;  // r 是对指针 p 的引用

r = &i;       // 其实就是，将指针 p 指向 i
*r = 3;       // *r 其实就是 i，也就是 p 指向的对象，把 i 的值改为 3
```

    

